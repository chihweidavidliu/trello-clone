const a11_0x2924=['extractGitRef','DteArtifactStorage','getRunGroup','E2EEncryption','defineProperty','./task-graph-creator','skipNxCache','getCIExecutionEnv','success','lifeCycle','getCIExecutionId','done','next','splitTasksIntoStages','../../error/print-run-group-error','encryptionKey','printRunGroupError','SIGTERM','log','VERBOSE_LOGGING','start','value','../../../utilities/nx-imports','values','createTaskGraphCompat','Main\x20job\x20was\x20terminated\x20via\x20SIGTERM','./split-task-graph-into-stages','SIGINT','./distributed-execution.api','createStartRequest','DistributedExecutionApi','endTasks','dte-main','extractGitSha','apply','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','exit','Successfully\x20completed\x20running\x20the\x20command.','See\x20run\x20details\x20at\x20','Unable\x20to\x20complete\x20a\x20run.','runUrl','completeRunGroupWithError','nxCloudDistributedTasksRunner','submitRunMetrics','axiosException','commandStatus','throw','../../../utilities/dte-artifact-storage','then','warn','../../../utilities/metric-logger','note','../../file-storage/e2e-encryption','error','scheduleTask','FileStorage','message','startTask','../../../utilities/environment'];(function(_0x31bd6a,_0x292468){const _0x29c7f6=function(_0x5de2d8){while(--_0x5de2d8){_0x31bd6a['push'](_0x31bd6a['shift']());}};_0x29c7f6(++_0x292468);}(a11_0x2924,0x135));const a11_0x29c7=function(_0x31bd6a,_0x292468){_0x31bd6a=_0x31bd6a-0x0;let _0x29c7f6=a11_0x2924[_0x31bd6a];return _0x29c7f6;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x375204,_0x59f31b,_0x2708f0,_0x3588b7){function _0x94b2ad(_0x28ec3f){return _0x28ec3f instanceof _0x2708f0?_0x28ec3f:new _0x2708f0(function(_0x4684f7){_0x4684f7(_0x28ec3f);});}return new(_0x2708f0||(_0x2708f0=Promise))(function(_0x20a60f,_0x81be8b){function _0x2a3573(_0x26c9db){try{_0x4c228c(_0x3588b7[a11_0x29c7('0x39')](_0x26c9db));}catch(_0x12604b){_0x81be8b(_0x12604b);}}function _0x2f5517(_0x4675a9){try{_0x4c228c(_0x3588b7[a11_0x29c7('0x20')](_0x4675a9));}catch(_0x24da57){_0x81be8b(_0x24da57);}}function _0x4c228c(_0x5a50fc){_0x5a50fc[a11_0x29c7('0x38')]?_0x20a60f(_0x5a50fc[a11_0x29c7('0x7')]):_0x94b2ad(_0x5a50fc['value'])[a11_0x29c7('0x22')](_0x2a3573,_0x2f5517);}_0x4c228c((_0x3588b7=_0x3588b7[a11_0x29c7('0x14')](_0x375204,_0x59f31b||[]))[a11_0x29c7('0x39')]());});};Object[a11_0x29c7('0x31')](exports,'__esModule',{'value':!![]});exports[a11_0x29c7('0x1c')]=void 0x0;const environment_1=require(a11_0x29c7('0x2c'));const metric_logger_1=require(a11_0x29c7('0x24'));const error_reporter_api_1=require('../../api/error-reporter.api');const print_run_group_error_1=require(a11_0x29c7('0x0'));const e2e_encryption_1=require(a11_0x29c7('0x26'));const file_storage_1=require('../../file-storage/file-storage');const distributed_execution_api_1=require(a11_0x29c7('0xe'));const split_task_graph_into_stages_1=require(a11_0x29c7('0xc'));const task_graph_creator_1=require(a11_0x29c7('0x32'));const process_tasks_1=require('./process-tasks');const dte_artifact_storage_1=require(a11_0x29c7('0x21'));const {output,cacheDirectory}=require(a11_0x29c7('0x8'));class NoopLifeCycle{[a11_0x29c7('0x28')](_0x1230a2){}[a11_0x29c7('0x2b')](_0x200d90){}[a11_0x29c7('0x11')](_0xc700a2){}}const nxCloudDistributedTasksRunner=(_0x2bde3a,_0x3e6967,_0x230096)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x3e6967[a11_0x29c7('0x33')]){output[a11_0x29c7('0x23')]({'title':'--skip-nx-cache\x20is\x20ignored\x20when\x20using\x20distributed\x20tasks\x20execution\x20(DTE).','bodyLine':['DTE\x20needs\x20the\x20cache\x20to\x20share\x20files\x20between\x20agents.']});}if(environment_1[a11_0x29c7('0x5')]){output[a11_0x29c7('0x25')]({'title':'Starting\x20distributed\x20command\x20execution'});}_0x3e6967[a11_0x29c7('0x36')]=new NoopLifeCycle();const _0x2e54f1=(0x0,environment_1['getBranch'])();const _0x32f07c=(0x0,environment_1[a11_0x29c7('0x2f')])();const _0x344181=(0x0,environment_1[a11_0x29c7('0x37')])();const _0x241274=(0x0,environment_1[a11_0x29c7('0x34')])();const _0x2fb723=(0x0,environment_1[a11_0x29c7('0x13')])();const _0x1149e1=(0x0,environment_1[a11_0x29c7('0x2d')])();if(!(0x0,print_run_group_error_1['canDetectRunGroup'])(_0x32f07c,_0x344181)){(0x0,print_run_group_error_1[a11_0x29c7('0x2')])();process['exit'](0x1);}const _0x1127cd=new e2e_encryption_1[(a11_0x29c7('0x30'))](environment_1['ENCRYPTION_KEY']||_0x3e6967[a11_0x29c7('0x1')]);const _0x35cc36=new error_reporter_api_1['ErrorReporterApi'](_0x3e6967);const _0x51c266=new dte_artifact_storage_1[(a11_0x29c7('0x2e'))](new file_storage_1[(a11_0x29c7('0x29'))](_0x1127cd,_0x35cc36,_0x3e6967,a11_0x29c7('0x12')),cacheDirectory);const _0x5e9cb5=new distributed_execution_api_1[(a11_0x29c7('0x10'))](_0x3e6967);attachSignalListenersToCompleteRunGroupOnError(_0x5e9cb5,_0x2e54f1,_0x32f07c,_0x344181,_0x241274);try{const _0x5be5ce=getTaskGraph(_0x230096,_0x2bde3a,_0x3e6967);const _0x154ba8=yield runDistributedExecution(_0x5e9cb5,_0x3e6967,_0x51c266,_0x2e54f1,_0x32f07c,_0x344181,_0x241274,_0x5be5ce,_0x2fb723,_0x1149e1);if(_0x154ba8[a11_0x29c7('0x1f')]===0x0){output[a11_0x29c7('0x35')]({'title':a11_0x29c7('0x17'),'bodyLines':[a11_0x29c7('0x18')+_0x154ba8[a11_0x29c7('0x1a')]]});}else{output[a11_0x29c7('0x27')]({'title':'Command\x20execution\x20failed.','bodyLines':[a11_0x29c7('0x18')+_0x154ba8[a11_0x29c7('0x1a')]]});}yield(0x0,metric_logger_1[a11_0x29c7('0x1d')])(_0x3e6967);process[a11_0x29c7('0x16')](_0x154ba8[a11_0x29c7('0x1f')]);}catch(_0x23dcb0){output['error']({'title':a11_0x29c7('0x19'),'bodyLines':[_0x23dcb0[a11_0x29c7('0x2a')]]});if(_0x23dcb0['axiosException']){console[a11_0x29c7('0x4')](_0x23dcb0[a11_0x29c7('0x1e')]);}else{console['log'](_0x23dcb0);}try{yield _0x5e9cb5[a11_0x29c7('0x1b')](_0x2e54f1,_0x32f07c,_0x344181,_0x241274,a11_0x29c7('0x15')+_0x23dcb0['message']+'\x22');}finally{process[a11_0x29c7('0x16')](0x1);}}});exports[a11_0x29c7('0x1c')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x5e97f7,_0x566759,_0x4184f8){if(_0x5e97f7['taskGraph']){return _0x5e97f7['taskGraph'];}else{return(0x0,task_graph_creator_1[a11_0x29c7('0xa')])(_0x4184f8,_0x5e97f7['projectGraph'],_0x566759);}}function attachSignalListenersToCompleteRunGroupOnError(_0xe3631,_0x5eac58,_0x5b2996,_0x560a7c,_0x3d4404){process['on'](a11_0x29c7('0xd'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0xe3631[a11_0x29c7('0x1b')](_0x5eac58,_0x5b2996,_0x560a7c,_0x3d4404,'Main\x20job\x20was\x20terminated\x20via\x20SIGINT');process[a11_0x29c7('0x16')](0x1);}));process['on'](a11_0x29c7('0x3'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0xe3631[a11_0x29c7('0x1b')](_0x5eac58,_0x5b2996,_0x560a7c,_0x3d4404,a11_0x29c7('0xb'));process['exit'](0x1);}));}function runDistributedExecution(_0x2dff12,_0x2b0a9c,_0x5be03a,_0x2302aa,_0x919ba3,_0x5c4447,_0xc6e8c9,_0x32b2bb,_0x28eafb,_0x5bd5b5){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x430ca8=yield _0x2dff12[a11_0x29c7('0x6')]((0x0,distributed_execution_api_1[a11_0x29c7('0xf')])(_0x2302aa,_0x919ba3,_0x5c4447,_0xc6e8c9,(0x0,split_task_graph_into_stages_1[a11_0x29c7('0x3a')])(_0x32b2bb),_0x2b0a9c,_0x28eafb));return yield(0x0,process_tasks_1['processTasks'])(_0x2dff12,_0x5be03a,_0x430ca8,Object[a11_0x29c7('0x9')](_0x32b2bb['tasks']));});}