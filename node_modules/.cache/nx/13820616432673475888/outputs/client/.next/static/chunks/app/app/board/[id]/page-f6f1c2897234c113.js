(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[767],{4278:function(e,r,t){Promise.resolve().then(t.bind(t,3280))},3280:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return p}});var n,l,o=t(7821),s=t(8078);let i=(e,r,t)=>{console.log("insert",{item:e,arr:r,index:t});let n=[...r];return n.splice(t,0,e),n},c=(e,r,t)=>{let n=[...e],l=n[r];return n.splice(r,1),n.splice(t,0,l),n};var a=e=>{let{ticket:r,columnId:t}=e;return(0,o.jsxs)("div",{"data-column-id":t,className:"mt-3 border-2 border-gray-100 hover:bg-gray-200 rounded-md bg-white shadow-sm cursor-pointer p-3 min-h-[5rem]",draggable:!0,id:r.id,children:[(0,o.jsx)("h3",{className:"my-1 text-md select-none",children:r.title}),r.assignedTo&&(0,o.jsxs)("p",{className:"my-1 text-sm select-none",children:["Assigned to: ",r.assignedTo.fullname]})]})};let d=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,u=function(){for(var e,r,t=0,n="";t<arguments.length;)(e=arguments[t++])&&(r=function e(r){var t,n,l="";if("string"==typeof r||"number"==typeof r)l+=r;else if("object"==typeof r){if(Array.isArray(r))for(t=0;t<r.length;t++)r[t]&&(n=e(r[t]))&&(l&&(l+=" "),l+=n);else for(t in r)r[t]&&(l&&(l+=" "),l+=t)}return l}(e))&&(n&&(n+=" "),n+=r);return n},m=(n=["min-h-[5rem] rounded-md"],l={variants:{visible:{true:["bg-gray-300","mt-3"]}}},e=>{var r;if((null==l?void 0:l.variants)==null)return u(n,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:t,defaultVariants:o}=l,s=Object.keys(t).map(r=>{let n=null==e?void 0:e[r],l=null==o?void 0:o[r];if(null===n)return null;let s=d(n)||d(l);return t[r][s]}),i=e&&Object.entries(e).reduce((e,r)=>{let[t,n]=r;return void 0===n||(e[t]=n),e},{}),c=null==l?void 0:null===(r=l.compoundVariants)||void 0===r?void 0:r.reduce((e,r)=>{let{class:t,className:n,...l}=r;return Object.entries(l).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...o,...i}[r]):({...o,...i})[r]===t})?[...e,t,n]:e},[]);return u(n,s,c,null==e?void 0:e.class,null==e?void 0:e.className)});var f=e=>{let{children:r,id:t,handleDrop:n,isVisible:l}=e,[i,c]=(0,s.useState)(!1),a=(0,s.useRef)(null),d=(0,s.useRef)(null),u=(0,s.useRef)(null),f=(0,s.useRef)(0),g=()=>{var e;d.current=null,null==u||null===(e=u.current)||void 0===e||e.remove()},p=async e=>{e.preventDefault();let r=e.dataTransfer.getData("text"),t=document.getElementById(r);if(!t||(console.log("draggedTicket",t),null===d.current||!a.current))return;let l=d.current;l?console.log("adding before"):console.log("adding after"),await n(t.id,l),g()},v=e=>{setTimeout(function(){e.style.display="none"},1)},h=e=>{e.style.display="revert"};return(0,o.jsx)("div",{className:m({visible:l}),onDragEnter:e=>{console.log("entering",t),f.current++,c(!0)},onDragLeave:e=>{f.current--,0===f.current&&(console.log("leaving",t),c(!1),g())},onDragOver:e=>{var r,t,n,l;e.preventDefault();let o=null===(r=a.current)||void 0===r?void 0:r.getBoundingClientRect();if(!o)return;let s=e.clientY-o.top<o.bottom-e.clientY;if(d.current===s)return;null===(t=u.current)||void 0===t||t.remove();let i=document.createElement("div");i.className="bg-gray-400 h-[5rem] my-3 rounded-md",u.current=i,s?null===(l=a.current)||void 0===l||l.prepend(i):null===(n=a.current)||void 0===n||n.append(i),d.current=s},onDrop:p,onDragStart:e=>{e.dataTransfer.setData("text",t),v(e.currentTarget)},onDragEnd:e=>{g(),h(e.currentTarget)},ref:a,id:t,children:(0,o.jsx)("div",{className:"dropzone-contents",children:r})})},g=e=>{let{column:{id:r,title:t,tickets:n},handleTicketDrop:l}=e,s=async(e,r)=>(e.includes("placeholder"),l(e,r));return(0,o.jsxs)("div",{className:"width-[18rem] min-w-[18rem] max-w-[18rem] py-4 px-3 rounded-md border-2 border-slate-300 bg-slate-100 shadow-lg",id:r,children:[(0,o.jsx)("h2",{className:"text-lg text-blue-950 font-semibold",children:t}),(0,o.jsx)("div",{className:"h-full",id:r+"-ticket-list",children:n.length>0?n.sort((e,r)=>e.index-r.index).map((e,t)=>(0,o.jsx)(f,{id:e.id,handleDrop:(e,r)=>{let l=n.findIndex(r=>r.id===e),o=-1!==l&&l<t,i=r||o?t:t+1;return s(e,i)},children:(0,o.jsx)(a,{ticket:e,columnId:r})},e.id)):(0,o.jsx)(f,{id:r+"-placeholder-dropzone",isVisible:!0,handleDrop:(e,r)=>s(e,0)})})]})};function p(e){let{initialColumns:r}=e,[t,n]=(0,s.useState)(r),l=t.reduce((e,r)=>(r.tickets.forEach(r=>{e[r.id]=r}),e),{}),a=async(e,r,o)=>{console.log("handling ticket drop",{ticketId:e,newColId:o,indexInNewCol:r});let s=t.map(t=>{let n=l[e];return n.columnId===o&&t.id===n.columnId?(console.log("source col === target col",t),{...t,tickets:c(t.tickets,n.index,r).map((e,r)=>({...e,index:r}))}):n.columnId===t.id?(console.log("source col",t),{...t,tickets:t.tickets.filter(e=>e.id!==n.id).map((e,r)=>({...e,index:r}))}):o===t.id?(console.log("target col",t),{...t,tickets:i({...n,columnId:o},t.tickets,r).map((e,r)=>({...e,index:r}))}):t});n(s),console.log("updatedCols",s)};return console.log("columns",t),(0,o.jsx)("div",{className:"flex gap-1",children:t.map(e=>(0,o.jsx)(g,{column:e,handleTicketDrop:(r,t)=>a(r,t,e.id)},e.id))})}},8489:function(e,r,t){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=t(8078),l=Symbol.for("react.element"),o=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,r,t){var n,c={},a=null,d=null;for(n in void 0!==t&&(a=""+t),void 0!==r.key&&(a=""+r.key),void 0!==r.ref&&(d=r.ref),r)o.call(r,n)&&!i.hasOwnProperty(n)&&(c[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===c[n]&&(c[n]=r[n]);return{$$typeof:l,type:e,key:a,ref:d,props:c,_owner:s.current}}r.jsx=c,r.jsxs=c},7821:function(e,r,t){"use strict";e.exports=t(8489)}},function(e){e.O(0,[115,443,744],function(){return e(e.s=4278)}),_N_E=e.O()}]);